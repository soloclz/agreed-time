# Developer Guide

Welcome to the AgreedTime developer documentation. This guide covers the project architecture, code standards, and contribution workflows.

---

## 1. Architecture & Patterns

This project is built with **Astro** (Static Shell) and **React** (Interactive Islands).

### Core Concept: Astro Islands
We follow the "HTML First" philosophy. The page shell (`Layout`, `Header`, `Text`) is static HTML generated by Astro. Only interactive widgets (like the Form and Calendar) are hydrated as React components using `client:load`.

### File Structure
*   **`src/pages/`**: File-system routing. `new.astro` corresponds to `/new`.
*   **`src/components/`**: React components and Astro snippets.
    *   `CreateEventForm.tsx`: The main "Island" controller.
    *   `TimeSlotSelector.tsx`: The core calendar widget logic.
*   **`src/utils/`**: Pure helper functions (e.g., date manipulation using `date-fns`).

### Key Logic: TimeSlotSelector
*   **State**: Selected slots are stored as a `Set<string>` of **UTC ISO Strings** (`2025-12-05T09:00:00Z`).
*   **Layout**: Uses a specific "Sticky Column" layout where the time labels are in a separate `div` from the scrollable date grid.
*   **Mobile**: Implements custom "Long Press" logic for drag-selection on touch devices.

---

## 2. Code Style & Standards

### Tech Stack
*   **Framework**: Astro + React 19
*   **Styling**: Tailwind CSS
*   **Language**: TypeScript (Strict mode)
*   **Date Handling**: `date-fns` (Always use UTC for storage, Local for display)

### Best Practices
*   **Functional Components**: Use React Hooks (`useState`, `useMemo`, `useCallback`).
*   **Props Interface**: Always define a TypeScript interface for component props.
*   **Tailwind**: Use utility classes directly. For complex logic, use conditional strings (template literals).
*   **Accessibility**: Ensure all interactive elements have `role`, `aria-label`, and keyboard support (`onKeyDown`).

---

## 3. Git Commit Convention

We follow the **[Conventional Commits](https://www.conventionalcommits.org/)** specification.

### Format
`type(scope): subject`

### Types
*   `feat`: New feature
*   `fix`: Bug fix
*   `docs`: Documentation only
*   `style`: Formatting (whitespace, semi-colons)
*   `refactor`: Code change that neither fixes a bug nor adds a feature
*   `chore`: Build process, deps, or auxiliary tools

### Example
*   `feat(calendar): add sticky time column`
*   `fix(mobile): resolve long-press selection bug`

---

## 4. Development Workflow

1.  **Start Dev Server**: `npm run dev`
2.  **Build for Production**: `npm run build`
3.  **Preview Build**: `npm run preview`

For detailed product specifications, see [PRODUCT_SPEC.md](./PRODUCT_SPEC.md).
